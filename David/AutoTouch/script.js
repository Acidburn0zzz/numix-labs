var bg, path, script;

defaultIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">\n <path d="m 47.437,11.547375 0,24.90625 c 0,10.25 0,10.984375 -10.984375,10.984375 l -24.902344,0 C 0.562,47.438 0.562,46.703625 0.562,36.453625 l 0,-24.90625 c 0,-10.2499996 0,-10.9843746 10.988281,-10.9843746 l 24.902344,0 C 47.437,0.5630004 47.437,1.2973754 47.437,11.547375 z" fill="{BG_DARK}"/>\n <path d="m 47.437,11.547375 0,20.906625 c 0,10.25 0,10.984 -10.984375,10.984 l -24.902344,0 C 0.562,43.438 0.562,42.704 0.562,32.454 l 0,-20.906625 c 0,-10.2500001 0,-10.9843751 10.988281,-10.9843751 l 24.902344,0 C 47.437,0.5629999 47.437,1.2973749 47.437,11.547375 z" fill="{BG}"/>\n {ICON_PATH}\n <path d="m 38.265125,47.438 c 2.542969,-0.01172 4.378906,-0.08203 5.710937,-0.441406 l -4.230468,-7.25 -4.484375,7.691406 1.191406,0 c 0.640625,0 1.242187,0 1.8125,0 z m 1.480469,-7.691406 -5.125,-8.789063 -5.128906,8.789063 z m 0,0 7.652344,0 c 0.03125,-0.972656 0.03906,-2.0625 0.03906,-3.296875 l 0,-1.097657 -2.5625,-4.394531 z m 5.128906,-8.789063 -5.128906,-8.789062 -5.125,8.789062 z m 0,0 2.5625,0 0,-4.394531 z m -10.253906,0 -5.128906,-8.789062 -5.125,8.789062 z m -10.253906,0 -5.128907,8.789063 10.253907,0 z m 0,0 -5.128907,-8.789062 -5.125,8.789062 z m -10.253907,0 -5.128906,8.789063 10.253906,0 z m 0,0 -5.128906,-8.789062 -5.125,8.789062 z m -10.253906,0 L 0.562,36.605969 c 0,1.167969 0.011719,2.210937 0.039062,3.140625 l 8.382813,0 z m 0,0 -3.296875,-5.648437 0,5.648437 z m 5.125,8.789063 -4.3125,7.394531 C 6.269031,47.434094 8.479969,47.438 11.550281,47.438 l 1.921875,0 z m 0,-17.578125 -5.125,-8.789063 -3.296875,5.648438 0,3.140625 z m 0,0 10.253906,0 -5.125,-8.789063 z m 5.128906,-8.789063 -5.128906,-8.7890622 -5.125,8.7890622 z m 0,0 10.253907,0 -5.128907,-8.7890622 z m 5.125,-8.7890622 -2.351562,-4.027344 -5.335938,0 c -0.07813,0 -0.140625,0 -0.214843,0 l -2.351563,4.027344 z m 0,0 10.253907,0 -2.351563,-4.027344 -5.550781,0 z m 10.253907,0 10.253906,0 -2.351563,-4.027344 c -0.3125,0 -0.609375,0 -0.941406,0 l -4.609375,0 z m 0,0 -5.125,8.7890622 10.253906,0 z m 5.128906,8.7890622 10.253906,0 -5.128906,-8.7890622 z m 0,0 -5.128906,8.789063 10.253906,0 z m 5.125,8.789063 7.691406,0 0,-4.394531 -2.5625,-4.394532 z m 5.128906,-8.789063 2.5625,0 0,-1.832031 c 0,-0.914063 -0.0078,-1.75 -0.02344,-2.523437 z m -15.382812,8.789063 -5.125,-8.789063 -5.128907,8.789063 z m 10.253906,-17.5781252 7.308594,0 C 46.4995,1.8325308 45.167469,0.9614378 42.022938,0.6879998 z m -30.761719,0 -2.304687,-3.953125 C 3.019031,0.8442498 1.538562,1.6333118 0.944812,4.5903438 z M 3.858875,13.379406 0.620594,7.8247188 C 0.577625,8.898938 0.562,10.133312 0.562,11.547375 l 0,1.832031 z m 15.378906,26.367188 -4.484375,7.691406 8.972656,0 z m 10.253907,0 -4.484376,7.691406 8.972657,0 z M 2.59325,46.367688 0.991688,43.621594 C 1.284656,44.938 1.776844,45.801281 2.59325,46.367688 z" fill="#ffffff" fill-opacity="{OPACITY}"/>\n</svg>';

iconName = 'icon';

if(document.getElementById('go')) {
	document.getElementById('go').onclick = make;
} else {
	document.getElementById('goauto').onclick = automake;
};

function automake() {
	iconName = document.getElementById('name').value;
	
	if(script !== undefined) {
		script.remove();
	};
	
	script = document.createElement('script');
	script.src = 'https://github.com/numixproject/numix-labs/raw/master/David/autotouch-icons/' + document.getElementById('name').value + '.js';
	document.head.appendChild(script);
	script.onload = function() {
		make('auto');
	};
};

function make(auto) {
	if(auto !== 'auto') {
		bg = document.getElementById('background').value;
		path = document.getElementById('path').value;
	};
	
	bgR = parseInt('0x' + bg[1] + bg[2]);
	bgG = parseInt('0x' + bg[3] + bg[4]);
	bgB = parseInt('0x' + bg[5] + bg[6]);
	
	bgdR = (bgR - 32).toString(16);
	bgdG = (bgG - 32).toString(16);
	bgdB = (bgB - 32).toString(16);
	
	if(bgdR.indexOf('-') !== -1) { bgdR = '00' };
	if(bgdG.indexOf('-') !== -1) { bgdG = '00' };
	if(bgdB.indexOf('-') !== -1) { bgdB = '00' };
	
	if(bgdR.length < 2) { bgdR = '0' + bgdR };
	if(bgdG.length < 2) { bgdG = '0' + bgdG };
	if(bgdB.length < 2) { bgdB = '0' + bgdB };
	
	bgDark = '#' + bgdR + bgdG + bgdB;
	
	opacity = ((bgR + bgG + bgB) / 18 + 4) * (1 / 255);
	
	defaultIcon = defaultIcon.replace('{BG}', bg);
	defaultIcon = defaultIcon.replace('{BG_DARK}', bgDark);
	defaultIcon = defaultIcon.replace('{ICON_PATH}', path);
	defaultIcon = defaultIcon.replace('{OPACITY}', opacity);
	
	document.getElementById('output').innerHTML = defaultIcon;
	document.getElementById('svg').innerHTML = defaultIcon;
	
	document.getElementById('download').disabled = false;
	
	file = new Blob([defaultIcon], {type: 'image/svg+xml;charset=utf-8'});
	
	defaultIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">\n <path d="m 47.437,11.547375 0,24.90625 c 0,10.25 0,10.984375 -10.984375,10.984375 l -24.902344,0 C 0.562,47.438 0.562,46.703625 0.562,36.453625 l 0,-24.90625 c 0,-10.2499996 0,-10.9843746 10.988281,-10.9843746 l 24.902344,0 C 47.437,0.5630004 47.437,1.2973754 47.437,11.547375 z" fill="{BG_DARK}"/>\n <path d="m 47.437,11.547375 0,20.906625 c 0,10.25 0,10.984 -10.984375,10.984 l -24.902344,0 C 0.562,43.438 0.562,42.704 0.562,32.454 l 0,-20.906625 c 0,-10.2500001 0,-10.9843751 10.988281,-10.9843751 l 24.902344,0 C 47.437,0.5629999 47.437,1.2973749 47.437,11.547375 z" fill="{BG}"/>\n {ICON_PATH}\n <path d="m 38.265125,47.438 c 2.542969,-0.01172 4.378906,-0.08203 5.710937,-0.441406 l -4.230468,-7.25 -4.484375,7.691406 1.191406,0 c 0.640625,0 1.242187,0 1.8125,0 z m 1.480469,-7.691406 -5.125,-8.789063 -5.128906,8.789063 z m 0,0 7.652344,0 c 0.03125,-0.972656 0.03906,-2.0625 0.03906,-3.296875 l 0,-1.097657 -2.5625,-4.394531 z m 5.128906,-8.789063 -5.128906,-8.789062 -5.125,8.789062 z m 0,0 2.5625,0 0,-4.394531 z m -10.253906,0 -5.128906,-8.789062 -5.125,8.789062 z m -10.253906,0 -5.128907,8.789063 10.253907,0 z m 0,0 -5.128907,-8.789062 -5.125,8.789062 z m -10.253907,0 -5.128906,8.789063 10.253906,0 z m 0,0 -5.128906,-8.789062 -5.125,8.789062 z m -10.253906,0 L 0.562,36.605969 c 0,1.167969 0.011719,2.210937 0.039062,3.140625 l 8.382813,0 z m 0,0 -3.296875,-5.648437 0,5.648437 z m 5.125,8.789063 -4.3125,7.394531 C 6.269031,47.434094 8.479969,47.438 11.550281,47.438 l 1.921875,0 z m 0,-17.578125 -5.125,-8.789063 -3.296875,5.648438 0,3.140625 z m 0,0 10.253906,0 -5.125,-8.789063 z m 5.128906,-8.789063 -5.128906,-8.7890622 -5.125,8.7890622 z m 0,0 10.253907,0 -5.128907,-8.7890622 z m 5.125,-8.7890622 -2.351562,-4.027344 -5.335938,0 c -0.07813,0 -0.140625,0 -0.214843,0 l -2.351563,4.027344 z m 0,0 10.253907,0 -2.351563,-4.027344 -5.550781,0 z m 10.253907,0 10.253906,0 -2.351563,-4.027344 c -0.3125,0 -0.609375,0 -0.941406,0 l -4.609375,0 z m 0,0 -5.125,8.7890622 10.253906,0 z m 5.128906,8.7890622 10.253906,0 -5.128906,-8.7890622 z m 0,0 -5.128906,8.789063 10.253906,0 z m 5.125,8.789063 7.691406,0 0,-4.394531 -2.5625,-4.394532 z m 5.128906,-8.789063 2.5625,0 0,-1.832031 c 0,-0.914063 -0.0078,-1.75 -0.02344,-2.523437 z m -15.382812,8.789063 -5.125,-8.789063 -5.128907,8.789063 z m 10.253906,-17.5781252 7.308594,0 C 46.4995,1.8325308 45.167469,0.9614378 42.022938,0.6879998 z m -30.761719,0 -2.304687,-3.953125 C 3.019031,0.8442498 1.538562,1.6333118 0.944812,4.5903438 z M 3.858875,13.379406 0.620594,7.8247188 C 0.577625,8.898938 0.562,10.133312 0.562,11.547375 l 0,1.832031 z m 15.378906,26.367188 -4.484375,7.691406 8.972656,0 z m 10.253907,0 -4.484376,7.691406 8.972657,0 z M 2.59325,46.367688 0.991688,43.621594 C 1.284656,44.938 1.776844,45.801281 2.59325,46.367688 z" fill="#ffffff" fill-opacity="{OPACITY}"/>\n</svg>';
	
	bg = undefined;
	path = undefined;
	
	return false;
};

document.getElementById('download').onclick = download;
function download() {
	saveAs(file, iconName + '.svg');
};
